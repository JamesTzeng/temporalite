const T=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),x=["workflowExecutionStartedEventAttributes","workflowExecutionCompletedEventAttributes","workflowExecutionFailedEventAttributes","workflowExecutionTimedOutEventAttributes","workflowTaskStartedEventAttributes","workflowTaskScheduledEventAttributes","workflowTaskCompletedEventAttributes","workflowTaskTimedOutEventAttributes","workflowTaskFailedEventAttributes","activityTaskScheduledEventAttributes","activityTaskCompletedEventAttributes","activityTaskStartedEventAttributes","activityTaskFailedEventAttributes","activityTaskTimedOutEventAttributes","timerStartedEventAttributes","timerFiredEventAttributes","activityTaskCancelRequestedEventAttributes","activityTaskCanceledEventAttributes","timerCanceledEventAttributes","markerRecordedEventAttributes","workflowExecutionSignaledEventAttributes","workflowExecutionTerminatedEventAttributes","workflowExecutionCancelRequestedEventAttributes","workflowExecutionCanceledEventAttributes","requestCancelExternalWorkflowExecutionInitiatedEventAttributes","requestCancelExternalWorkflowExecutionFailedEventAttributes","externalWorkflowExecutionCancelRequestedEventAttributes","workflowExecutionContinuedAsNewEventAttributes","startChildWorkflowExecutionInitiatedEventAttributes","startChildWorkflowExecutionFailedEventAttributes","childWorkflowExecutionStartedEventAttributes","childWorkflowExecutionCompletedEventAttributes","childWorkflowExecutionFailedEventAttributes","childWorkflowExecutionCanceledEventAttributes","childWorkflowExecutionTimedOutEventAttributes","childWorkflowExecutionTerminatedEventAttributes","signalExternalWorkflowExecutionInitiatedEventAttributes","signalExternalWorkflowExecutionFailedEventAttributes","externalWorkflowExecutionSignaledEventAttributes","upsertWorkflowSearchAttributesEventAttributes"],S=t=>{for(const e of x)if(e in t)return e},y=(t,e)=>t[e],K=t=>{const e=S(t),r=y(t,e);return{key:e,attributes:r}},i=t=>e=>Boolean(e[t]),M=i("workflowExecutionCompletedEventAttributes"),l=i("activityTaskScheduledEventAttributes"),C=i("activityTaskStartedEventAttributes"),h=i("activityTaskCompletedEventAttributes"),g=i("activityTaskFailedEventAttributes"),W=i("activityTaskTimedOutEventAttributes"),f=i("timerStartedEventAttributes"),p=i("timerFiredEventAttributes"),I=i("activityTaskCancelRequestedEventAttributes"),F=i("activityTaskCanceledEventAttributes"),R=i("timerCanceledEventAttributes"),k=i("markerRecordedEventAttributes"),A=i("workflowExecutionSignaledEventAttributes"),b=i("startChildWorkflowExecutionInitiatedEventAttributes"),q=i("childWorkflowExecutionStartedEventAttributes"),O=i("childWorkflowExecutionCompletedEventAttributes"),v=i("signalExternalWorkflowExecutionInitiatedEventAttributes"),m=t=>{if(l(t)||b(t)||f(t)||v(t)||A(t)||k(t))return t.id;if(C(t))return String(t.activityTaskStartedEventAttributes.scheduledEventId);if(F(t))return String(t.activityTaskCanceledEventAttributes.scheduledEventId);if(I(t))return String(t.activityTaskCancelRequestedEventAttributes.scheduledEventId);if(g(t))return String(t.activityTaskFailedEventAttributes.scheduledEventId);if(W(t))return String(t.activityTaskTimedOutEventAttributes.scheduledEventId);if(h(t))return String(t.activityTaskCompletedEventAttributes.scheduledEventId);if(q(t))return String(t.childWorkflowExecutionStartedEventAttributes.initiatedEventId);if(O(t))return String(t.childWorkflowExecutionCompletedEventAttributes.initiatedEventId);if(p(t))return String(t.timerFiredEventAttributes.startedEventId);if(R(t))return String(t.timerCanceledEventAttributes.startedEventId)},N=t=>{var e,r,s,n,c,E,a,d,o;if(!!t){if(l(t))return(r=(e=t.activityTaskScheduledEventAttributes)==null?void 0:e.activityType)==null?void 0:r.name;if(f(t))return`Timer ${(s=t.timerStartedEventAttributes)==null?void 0:s.timerId} (${(n=t.timerStartedEventAttributes)==null?void 0:n.startToFireTimeout})`;if(v(t))return`Signal: ${(c=t.signalExternalWorkflowExecutionInitiatedEventAttributes)==null?void 0:c.signalName}`;if(A(t))return`Signal received: ${(E=t.workflowExecutionSignaledEventAttributes)==null?void 0:E.signalName}`;if(k(t))return`Marker: ${(a=t.markerRecordedEventAttributes)==null?void 0:a.markerName}`;if(b(t))return`Child Workflow: ${(o=(d=t.startChildWorkflowExecutionInitiatedEventAttributes)==null?void 0:d.workflowType)==null?void 0:o.name}`}},w=({events:t})=>{let e=0,r;for(const s of t.values()){const n=Number(s.id);n>=e&&(e=n,r=s)}return r},u=t=>{const e=m(t),r=N(t),{timestamp:s,category:n,classification:c}=t,E=t,a=new Map,d=new Set;return a.set(t.id,t),d.add(t.id),{id:e,name:r,events:a,eventIds:d,initialEvent:E,timestamp:s,category:n,classification:c,get eventTime(){var o;return(o=w(this))==null?void 0:o.eventTime},get attributes(){var o;return(o=w(this))==null?void 0:o.attributes}}},$=t=>{if(l(t)||b(t)||f(t)||v(t)||A(t)||k(t))return u(t)},G=(t,e)=>{!t||(t.events.set(e.id,e),t.eventIds.add(e.id),t.timestamp=e.timestamp)},j=t=>{const e={};for(const r of t){const s=m(r),n=$(r);n?e[n.id]=n:G(e[s],r)}return Object.values(e)},B=t=>t==null?!1:T(t,"events");export{W as a,B as b,w as c,K as f,j as g,M as i};
